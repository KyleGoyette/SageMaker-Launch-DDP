FROM pytorch/pytorch:1.12.1-cuda11.3-cudnn8-runtime
COPY ./train_dis.py /
WORKDIR /
RUN pip install wandb
# Set NCCL and PyTorch environment variables
ENV NCCL_DEBUG=INFO
ENV NCCL_DEBUG_SUBSYS=ALL
ENV NCCL_SOCKET_IFNAME=eth0
ENV NCCL_IB_DISABLE=1
ENV NCCL_P2P_LEVEL=NVL
ENV TORCH_DISTRIBUTED_DEBUG=INFO
